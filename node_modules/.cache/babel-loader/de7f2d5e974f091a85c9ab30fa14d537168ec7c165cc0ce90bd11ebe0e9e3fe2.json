{"ast":null,"code":"import _slicedToArray from\"C:/Users/Toshiba/OneDrive/Documents/WEB DEVELOPMENT/BlooduApp/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// this will return the current users posts \nimport axios from\"axios\";import{Link,useHistory}from\"react-router-dom\";import React,{useEffect,useState}from\"react\";import{toast}from\"react-toastify\";import Post from\"./PostDetail/Post\";import{CircularProgress,Box,AppBar,Grid,IconButton,Toolbar,Typography,Card,CardMedia,CardContent,CardActions,Button}from'@mui/material';import HomeRoundedIcon from'@mui/icons-material/HomeRounded';import useStyles from'./styles';import DeleteIcon from'@mui/icons-material/Delete';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Myrequests(){// let history = useHistory()\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),cnic=_useState2[0],setCnic=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),key=_useState4[0],setKey=_useState4[1];var classes=useStyles();var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),requestList=_useState6[0],setRequestList=_useState6[1];var navigate=useHistory();useEffect(function(){axios.get('http://localhost:3005/api/Person/personinfo',{headers:{accessToken2:sessionStorage.getItem(\"accessToken2\")}}).then(function(response){if(response.data.error){console.log(response.data.error);}else{setCnic(response.data[0].cnic);}});},[]);useEffect(function(){axios.get(\"http://localhost:3005/api/Request/myrequests\",{headers:{accessToken2:sessionStorage.getItem(\"accessToken2\")}}).then(function(response){if(response.data.error){toast.error('You are not authenticated to use this feature');}if(response.data.err){toast.error('No post exist');}else if(response.data){console.log(response.data);setRequestList(response.data);}});},[key]);// inner function ends \nreturn/*#__PURE__*/_jsxs(Box,{sx:{flexGrow:1},children:[/*#__PURE__*/_jsx(AppBar,{style:{backgroundColor:'crimson'},position:\"static\",children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(IconButton,{size:\"large\",edge:\"false\",color:\"inherit\",\"aria-label\":\"menu\",sx:{mr:2},onClick:function onClick(){navigate.push('/user');},children:/*#__PURE__*/_jsx(HomeRoundedIcon,{style:{height:'50px',width:'50px'}})}),/*#__PURE__*/_jsx(Typography,{variant:\"h1\",children:\"My Posts\"})]})}),requestList.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',marginTop:\"30px\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"No Post Found\"}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'20px',marginTop:'5px'},children:/*#__PURE__*/_jsx(CircularProgress,{})})]}),requestList&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:9,children:/*#__PURE__*/_jsx(Grid,{className:classes.mainContainer,container:true,alignItems:\"stretch\",spacing:3,children:requestList.map(function(post){return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:12,md:6,lg:3,children:/*#__PURE__*/_jsxs(Card,{className:classes.card,raised:true,elevation:6,children:[/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:post===null||post===void 0?void 0:post.profile}),/*#__PURE__*/_jsxs(\"div\",{className:classes.overlay,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"ID: \",post===null||post===void 0?void 0:post.req_id]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"Posted: \",post===null||post===void 0?void 0:post.Time]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginLeft:'20px'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Group: \",post===null||post===void 0?void 0:post.bloodGroup]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Bottles Needed: \",post===null||post===void 0?void 0:post.Qtyneed]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Time Period: \",post===null||post===void 0?void 0:post.TimePeriod,\" days\"]})]}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"Message: \",post===null||post===void 0?void 0:post.Reason]})}),/*#__PURE__*/_jsx(CardActions,{className:classes.cardActions,children:cnic===Number(post===null||post===void 0?void 0:post.cnic)&&/*#__PURE__*/_jsxs(Button,{size:\"small\",color:\"primary\",onClick:function onClick(){axios.delete(\"http://localhost:3005/api/Request/delete/\".concat(post===null||post===void 0?void 0:post.req_id),{headers:{accessToken2:sessionStorage.getItem(\"accessToken2\")}}).then(function(response){if(response.data.error){console.log(response.data.error);}else{console.log(\"deleted successfully\");setKey(key+1);}});},children:[/*#__PURE__*/_jsx(DeleteIcon,{fontSize:\"medium\"}),\"Delete\"]})})]})},post===null||post===void 0?void 0:post.req_id);})})})]});}export default Myrequests;","map":{"version":3,"names":["axios","Link","useHistory","React","useEffect","useState","toast","Post","CircularProgress","Box","AppBar","Grid","IconButton","Toolbar","Typography","Card","CardMedia","CardContent","CardActions","Button","HomeRoundedIcon","useStyles","DeleteIcon","Myrequests","cnic","setCnic","key","setKey","classes","requestList","setRequestList","navigate","get","headers","accessToken2","sessionStorage","getItem","then","response","data","error","console","log","err","flexGrow","backgroundColor","mr","push","height","width","length","display","marginTop","marginLeft","mainContainer","map","post","card","media","profile","overlay","req_id","Time","bloodGroup","Qtyneed","TimePeriod","Reason","cardActions","Number","delete"],"sources":["C:/Users/Toshiba/OneDrive/Documents/WEB DEVELOPMENT/BlooduApp/client/src/components/Post/Myrequests.js"],"sourcesContent":["// this will return the current users posts \r\n\r\nimport axios from \"axios\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport Post from \"./PostDetail/Post\";\r\nimport {CircularProgress,Box, AppBar, Grid, IconButton, Toolbar, Typography, Card, CardMedia, CardContent, CardActions, Button} from '@mui/material';\r\nimport HomeRoundedIcon from '@mui/icons-material/HomeRounded';\r\nimport useStyles from './styles';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nfunction Myrequests(){\r\n    // let history = useHistory()\r\n   \r\n    const [cnic, setCnic] = useState(\"\");\r\n    const [key, setKey] = useState(0);\r\n    const classes = useStyles();\r\n    const [requestList, setRequestList] = useState([])\r\n    const navigate = useHistory();\r\n\r\n\r\n    useEffect(() => {\r\n        axios.get('http://localhost:3005/api/Person/personinfo', {\r\n            headers: {\r\n                accessToken2: sessionStorage.getItem(\"accessToken2\"),\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.error) {\r\n                console.log(response.data.error);\r\n\r\n            } else {\r\n                setCnic(response.data[0].cnic)\r\n\r\n            }\r\n        })\r\n    }, [])\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n        axios.get(\"http://localhost:3005/api/Request/myrequests\", {\r\n            headers:{\r\n                accessToken2: sessionStorage.getItem(\"accessToken2\"),\r\n            }\r\n        }).then((response)=>{\r\n            if(response.data.error){\r\n                toast.error('You are not authenticated to use this feature')\r\n            }if(response.data.err){\r\n                toast.error('No post exist')\r\n            }\r\n            else if(response.data){\r\n                console.log(response.data);\r\n                setRequestList(response.data)\r\n            }\r\n        })\r\n\r\n    }, [key])  // inner function ends \r\n    \r\n    return (\r\n\r\n        <Box  sx={{ flexGrow: 1 }}>\r\n   \r\n    <AppBar style={{backgroundColor:'crimson'}} position=\"static\">\r\n    \r\n      <Toolbar>\r\n      <IconButton\r\n          size=\"large\"\r\n          edge=\"false\"\r\n          color=\"inherit\"\r\n          aria-label=\"menu\"\r\n          sx={{ mr: 2  }}\r\n          onClick={()=>{\r\n            navigate.push('/user');\r\n          }}\r\n       \r\n        >\r\n          <HomeRoundedIcon style={{height:'50px', width:'50px'}} />\r\n        </IconButton>\r\n        <Typography variant=\"h1\" >My Posts</Typography>\r\n        \r\n        </Toolbar>\r\n       \r\n    </AppBar> \r\n\r\n    \r\n        {(requestList.length === 0) &&(\r\n            <div style={{display:'flex', marginTop:\"30px\"}}>\r\n                <Typography variant=\"h3\">No Post Found</Typography> \r\n                <span style={{marginLeft:'20px', marginTop:'5px'}} ><CircularProgress/></span>\r\n            \r\n            </div>\r\n        )}\r\n        {requestList &&(\r\n\r\n        \r\n        <Grid item xs={12} sm={6} md={9}>\r\n\r\n            <Grid className={classes.mainContainer} container alignItems=\"stretch\" spacing={3}>\r\n\r\n                {\r\n                    requestList.map((post) => (\r\n\r\n                        <Grid key={post?.req_id} item xs={12} sm={12} md={6} lg={3}>\r\n                            <Card className={classes.card} raised elevation={6}>\r\n                                <CardMedia className={classes.media} image={post?.profile} />\r\n                                <div className={classes.overlay}>\r\n                                    <Typography variant='h6'>ID: {post?.req_id}</Typography>\r\n                                    <Typography variant='body2'>Posted: {post?.Time}</Typography>\r\n\r\n                                </div>\r\n                                <div style={{ marginLeft: '20px' }}>\r\n                                    <Typography variant='h6' gutterBottom>Group: {post?.bloodGroup}</Typography>\r\n                                    <Typography variant='h6' gutterBottom>Bottles Needed: {post?.Qtyneed}</Typography>\r\n                                    <Typography variant='h6' gutterBottom>Time Period: {post?.TimePeriod} days</Typography>\r\n                                </div>\r\n                                <CardContent>\r\n                                    <Typography variant='body2' color=\"textSecondary\" >Message: {post?.Reason}</Typography>\r\n\r\n\r\n                                </CardContent>\r\n                                <CardActions className={classes.cardActions}>\r\n                                    {(cnic === Number(post?.cnic)) && (\r\n\r\n                                        <Button size='small' color='primary' onClick={() => {\r\n\r\n                                            axios.delete(`http://localhost:3005/api/Request/delete/${post?.req_id}`, {\r\n                                                headers: {\r\n                                                    accessToken2: sessionStorage.getItem(\"accessToken2\"),\r\n                                                }\r\n                                            }).then((response) => {\r\n                                                if (response.data.error) {\r\n                                                    console.log(response.data.error);\r\n                                                } else {\r\n                                                    console.log(\"deleted successfully\");\r\n                                                    setKey(key+1);\r\n                                                }\r\n                                            })\r\n                                        }}>\r\n                                            <DeleteIcon fontSize='medium' />\r\n                                            Delete\r\n                                        </Button>\r\n\r\n                                    )}\r\n\r\n                                </CardActions>\r\n\r\n                            </Card>\r\n                        </Grid>\r\n                    )\r\n                    )\r\n                }\r\n            </Grid>\r\n        </Grid>\r\n        )}\r\n       </Box>\r\n    );\r\n\r\n\r\n}\r\n\r\nexport default Myrequests;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}